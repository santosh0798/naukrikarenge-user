<!DOCTYPE html>
<html class="no-js" lang="zxx">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>Job board HTML-5 Template</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="manifest" href="site.webmanifest" />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="assets/img/favicon.ico"
    />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />
    <script
      type="application/javascript"
      crossorigin="anonymous"
      src="script.js"
    ></script>
    <script
      type="application/javascript"
      crossorigin="anonymous"
      src="https://securegw-stage.paytm.in/merchantpgpui/checkoutjs/merchants/npOzSP43040957754935.js"
    ></script>
    <!-- CSS here -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="index.css" />
    <link rel="stylesheet" href="assets/css/owl.carousel.min.css" />
    <link rel="stylesheet" href="assets/css/flaticon.css" />
    <link rel="stylesheet" href="assets/css/slicknav.css" />
    <link rel="stylesheet" href="assets/css/price_rangs.css" />
    <link rel="stylesheet" href="assets/css/animate.min.css" />
    <link rel="stylesheet" href="assets/css/magnific-popup.css" />
    <link rel="stylesheet" href="assets/css/fontawesome-all.min.css" />
    <link rel="stylesheet" href="assets/css/themify-icons.css" />
    <link rel="stylesheet" href="assets/css/slick.css" />
    <link rel="stylesheet" href="assets/css/nice-select.css" />
    <link rel="stylesheet" href="assets/css/style.css" />
  </head>

  <body>
    <!-- Preloader Start -->
    <div id="preloader-active">
      <div class="preloader d-flex align-items-center justify-content-center">
        <div class="preloader-inner position-relative">
          <div class="preloader-circle"></div>
          <div class="preloader-img pere-text">
            <img src="assets/img/logo/logo.svg" alt="" />
          </div>
        </div>
      </div>
    </div>
    <!-- Preloader Start -->
    <header>
      <!-- Header Start -->
      <div class="header-area header-transparrent">
        <div class="headder-top header-sticky">
          <div class="container">
            <div class="row align-items-center">
              <div class="col-lg-3 col-md-2">
                <!-- Logo -->
                <div class="logo">
                  <a href="index.html"
                    ><img
                          width="125"
                          height="50"
                      src="assets/img/logo/logo.svg"
                      alt="Naukri Karenge Header Logo"
                  /></a>
                </div>
              </div>
              <div class="col-lg-9 col-md-9">
                <div class="menu-wrapper">
                  <!-- Main-menu -->
                  <div class="main-menu">
                    <nav class="d-none d-lg-block">
                      <ul id="navigation">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="job_listing.html">Find a Job </a></li>
                        <li><a href="#">Companies </a></li>
                        <li><a href="#">Service</a></li>
                        <li><a href="contact.html">Contact</a></li>
                        <!-- <li class="d-lg-none" style="display: flex">
                          <a href="login.html">
                            <button type="button" class="btn">Login</button>
                          </a>
                          <a href="register.html">
                            <button type="button" class="btn">Register</button>
                          </a>
                        </li> -->
                      </ul>
                    </nav>
                  </div>
                  <!-- Header-btn -->
                  <div class="header-btn f-right" id="reglog">
                    <a href="register.html" class="btn head-btn1">Register</a>
                    <a href="login.html" class="btn head-btn2">Login</a>
                  </div>
                  <div id="logout">
                    <a href="profile.html" class="btn head-btn1"
                      ><i class="fa fa-user"></i
                    ></a>
                  </div>
                </div>
              </div>
              <!-- Mobile Menu -->
              <div class="col-12">
                <div class="mobile_menu d-block d-lg-none"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Header End -->
    </header>

    <main>
      <div class="reglog1" style="text-align: center"></div>

      <div id="card"></div>

      <!-- job post company Start -->
      <div class="job-post-company pt-120 pb-120">
        <div class="container" id="container"></div>
      </div>
      <!-- job post company End -->
    </main>
    <footer>
      <!-- Footer Start-->
      <div class="footer-area footer-bg footer-padding">
        <div class="container">
          <div class="row d-flex justify-content-between">
            <div class="col-xl-3 col-lg-3 col-md-4 col-sm-6">
              <div class="single-footer-caption mb-50">
                <div class="single-footer-caption mb-30">
                  <div class="footer-tittle">
                    <h4>For Company</h4>
                    <ul>
                      <li>
                        <a
                                href="https://naukrikarenge.netlify.app/#/auth/signup"
                        >
                          Signup</a
                        >
                      </li>
                      <li>
                        <a
                                href="https://naukrikarenge.netlify.app/#/auth/signin"
                        >Login</a
                        >
                      </li>
                      <!--                      <li><a href="#">Companies</a></li>-->
                      <!--                      <li><a href="#">FAQ's</a></li>-->
                    </ul>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-xl-3 col-lg-3 col-md-4 col-sm-5">
              <div class="single-footer-caption mb-50">
                <div class="footer-tittle">
                  <h4>Important Link</h4>
                  <ul>
                    <li><a href="privacy.html">Privacy Policy</a></li>
                    <li><a href="terms.html">Terms & conditions</a></li>
                    <li><a href="refund.html">Refund & Cancellation</a></li>
                    <li><a href="contact.html">Contact Us</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="col-xl-3 col-lg-3 col-md-4 col-sm-5">
              <div class="single-footer-caption mb-50">
                <div class="footer-tittle">
                  <h4>Job Seekers</h4>
                  <ul>
                    <li><a href="login.html">Login</a></li>
                    <li><a href="job_listing.html">Job Search</a></li>
                    <li><a href="register.html">Create Account</a></li>
                    <li><a href="">Upload Resume</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="col-xl-3 col-lg-3 col-md-4 col-sm-5">
              <div class="single-footer-caption mb-50">
                <div class="footer-tittle">
                  <h4>Contact Info</h4>
                  <ul>
                    <li><a href="#">Phone : +91 9737783888</a></li>
                    <li><a href="#">Email : support@naukrikarenge.com</a></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <!--  -->
          <div class="row footer-wejed justify-content-between">
            <div class="col-xl-3 col-lg-3 col-md-4 col-sm-6">
              <!-- logo -->
              <div class="footer-tittle-bottom">
                <span>3000+</span>
                <p>Available Work</p>
              </div>
            </div>
            <div class="col-xl-3 col-lg-3 col-md-4 col-sm-5">
              <div class="footer-tittle-bottom">
                <span>1500+</span>
                <p>Job Seekers</p>
              </div>
            </div>
            <div class="col-xl-3 col-lg-3 col-md-4 col-sm-5">
              <div class="footer-tittle-bottom">
                <span>50 +</span>
                <p>Company Trusted</p>
              </div>
            </div>
            <div class="col-xl-3 col-lg-3 col-md-4 col-sm-5">
              <!-- Footer Bottom Tittle -->
              <div class="footer-tittle-bottom">
                <span>568</span>
                <p>Talented Hunter</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- footer-bottom area -->
      <div class="footer-bottom-area footer-bg">
        <div class="container">
          <div class="footer-border">
            <div class="row d-flex justify-content-between align-items-center">
              <div class="col-xl-10 col-lg-10">
                <div class="footer-copy-right">
                  <p>
                    &copy;
                    <script>
                      document.write(new Date().getFullYear());
                    </script>
                    <a href="">naukrikarenge.com</a>. All rights reserved.
                  </p>
                </div>
              </div>
              <div class="col-xl-2 col-lg-2">
                <div class="footer-social f-right">
                  <a href="#"><i class="fab fa-facebook-f"></i></a>
                  <a href="#"><i class="fab fa-twitter"></i></a>
                  <a href="#"><i class="fab fa-linkedin"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Footer End-->
    </footer>

    <!-- JS here -->

    <!-- All JS Custom Plugins Link Here here -->
    <script src="./assets/js/vendor/modernizr-3.5.0.min.js"></script>
    <!-- Jquery, Popper, Bootstrap -->
    <script src="./assets/js/vendor/jquery-1.12.4.min.js"></script>
    <script src="./assets/js/popper.min.js"></script>
    <script src="./assets/js/bootstrap.min.js"></script>
    <!-- Jquery Mobile Menu -->
    <script src="./assets/js/jquery.slicknav.min.js"></script>

    <!-- Jquery Slick , Owl-Carousel Plugins -->
    <script src="./assets/js/owl.carousel.min.js"></script>
    <script src="./assets/js/slick.min.js"></script>
    <script src="./assets/js/price_rangs.js"></script>

    <!-- One Page, Animated-HeadLin -->
    <script src="./assets/js/wow.min.js"></script>
    <script src="./assets/js/animated.headline.js"></script>
    <script src="./assets/js/jquery.magnific-popup.js"></script>

    <!-- Scrollup, nice-select, sticky -->
    <script src="./assets/js/jquery.scrollUp.min.js"></script>
    <script src="./assets/js/jquery.nice-select.min.js"></script>
    <script src="./assets/js/jquery.sticky.js"></script>

    <!-- contact js -->
    <script src="./assets/js/contact.js"></script>
    <script src="./assets/js/jquery.form.js"></script>
    <script src="./assets/js/jquery.validate.min.js"></script>
    <script src="./assets/js/mail-script.js"></script>
    <script src="./assets/js/jquery.ajaxchimp.min.js"></script>

    <!-- Jquery Plugins, main Jquery -->
    <script src="./assets/js/plugins.js"></script>
    <script src="./assets/js/main.js"></script>

    <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-app.js"></script>
    <!-- TODO: Add SDKs for Firebase products that you want to use
https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-analytics.js"></script>
    <!-- Add Firebase products that you want to use -->

    <script src="https://www.gstatic.com/firebasejs/8.2.8/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-storage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-auth.js"></script>

    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

    <script>
      const config = {
        apiKey: "AIzaSyCn679YVgO0-aiLgpMBX2vIF0yn4FfMH5c",
        authDomain: "naukri-karenge.firebaseapp.com",
        projectId: "naukri-karenge",
        storageBucket: "naukri-karenge.appspot.com",
        messagingSenderId: "454119720002",
        appId: "1:454119720002:web:811d736402ea05b409d9db",
        measurementId: "G-3S3EJ7PR1N",
      };
      firebase.initializeApp(config);
      firebase.analytics();
      let db = firebase.firestore();

      let rand = Math.floor(Math.random() * 10000 + 1);

      const urlSearchParams = new URLSearchParams(window.location.search);
      const params = Object.fromEntries(urlSearchParams.entries());
      console.log(params);

      let company = "";

      db.collection("JobPost")
        .doc(params.id)
        .get()
        .then(async (element) => {
          let docid = element.id;

          console.log(element.data().company);

          company = await element.data().company;

          db.collection("Company")
            .doc(element.data().company)
            .get()
            .then((elementa) => {
              var data = element.data();
              let date = new Date(data.createdAt.toDate());
              const monthNames = [
                "Jan",
                "Feb",
                "Mar",
                "Apr",
                "May",
                "Jun",
                "Jul",
                "Aug",
                "Sept",
                "Oct",
                "Nov",
                "Dec",
              ];
              let y = `<div class="row justify-content-between">
                              <!-- Left Content -->
                              <div class="col-xl-7 col-lg-8">
                                <!-- job single -->
                                <div class="single-job-items mb-50">
                                  <div class="job-items">
                                    <div class="company-img company-img-details">
                                      <a href="#"
                                        ><img width="100" height="75" src="${
                                          elementa.data().img
                                        }" alt=""
                                      /></a>
                                    </div>
                                    <div class="job-tittle">
                                      <a href="#">
                                        <h4>${data.title}</h4>
                                      </a>
                                      <ul>
                                        <li>${elementa.data().company}</li>
                                        <li>
                                          <i class="fas fa-map-marker-alt"></i>${
                                            data.location
                                          }
                                        </li>
                                        <li>${data.salary}</li>
                                      </ul>
                                    </div>
                                  </div>
                                </div>
                                <!-- job single End -->

                                <div class="job-post-details">
                                  <div class="post-details1 mb-50">
                                    <!-- Small Section Tittle -->
                                    <div class="small-section-tittle">
                                      <h4>Job Description</h4>
                                    </div>
                                    <p>
                                      ${data.description}
                                    </p>

                                  </div>

                                  <div class="post-details1 mb-50">
                                    <div class="small-section-tittle">
                                      <h4>Required Knowledge, Skills, and Abilities</h4>
                                    </div>
                                    <p>
                                      ${data.description}
                                    </p>
                                  </div>

                                    <div class="small-section-tittle">
                                      <h4>Education + Experience</h4>
                                    </div>
                                    <p>
                                      ${data.description}
                                    </p>
<!--                                  <div class="post-details2 mb-50">-->

<!--                                  -->
<!--                                  </div>-->

                                </div>
                              </div>
                              <!-- Right Content -->
                              <div class="col-xl-4 col-lg-4">
                                <div class="post-details3 mb-50">
                                  <!-- Small Section Tittle -->
                                  <div class="small-section-tittle">
                                    <h4>Job Overview</h4>
                                  </div>
                                  <ul>
                                    <li>Posted date : <span>${
                                      date.getDate() +
                                      "-" +
                                      monthNames[date.getMonth()] +
                                      "-" +
                                      date.getFullYear()
                                    }</span></li>
                                    <li>Location : <span>${
                                      data.location
                                    }</span></li>
                                    <li>Vacancy : <span>${
                                      data.vacancy
                                    }</span></li>

                                    <li>Salary : <span>${
                                      data.salary
                                    }</span></li>
                                    <li>Application date : <span>${
                                      date.getDate() +
                                      "-" +
                                      monthNames[date.getMonth()] +
                                      "-" +
                                      date.getFullYear()
                                    }</span></li>
                                  </ul>
                                  <div class="apply-btn2">
                                    <button onclick="applyJob()" id="apply" class="btn">Apply Now</button>
                                  </div>
                                </div>
                                <div class="post-details4 mb-50">
                                  <!-- Small Section Tittle -->
                                  <div class="small-section-tittle">
                                    <h4>About ${elementa.data().company}</h4>
                                  </div>

                                  <p>
                                    It is a long established fact that a reader will be distracted
                                    by the readable content of a page when looking at its layout.
                                  </p>
                                  <ul>

                                    <li>Web : <span> ${elementa.data().web}</span></li>
                                    <li>Email: <span>${elementa.data().email}</span></li>
                                  </ul>
                                </div>
                              </div>
                            </div>
                  `;

              var wrapper2 = document.createElement("div");
              wrapper2.innerHTML = y;

              document.getElementById("container").appendChild(wrapper2);

              console.log(elementa.data());
            });
        })
        .catch((error) => {
          console.error("Error adding document: ", error);
        });

      //payment handler

      const paymentHandler = async () => {
        let optionss = {
          method: "GET",
        };

        const response = await fetch(
          `https://naukrikarenge-razorpayment.herokuapp.com/api/payment/INR/499`,
          optionss
        );

        const data = await response.json();

        const order = data;
        console.log(data);

        const options = {
          key: "rzp_live_jq9A34mw0APVFC",
          name: "Naukri",
          currency: "INR",
          description: "Pay for Naukri",
          order_id: order.id,
          handler: async (response) => {
            try {
              console.log(response);
              const captureResponse = await fetch(
                `https://naukrikarenge-razorpayment.herokuapp.com/api/capture/${response.razorpay_payment_id}/499`,
                {
                  method: "POST",
                  mode: "cors",
                }
              );
              console.log(captureResponse);
              if (captureResponse.ok == true) {
                db.collection("appliedJob")
                  .add({
                    id: params.id,
                    isSelected: false,
                    userid: JSON.parse(localStorage.getItem("userId")),
                    company: company,
                  })
                  .then(() => {
                    window.alert("Applied successfully");
                  });

                db.collection("candidates")
                  .doc(JSON.parse(localStorage.getItem("userId")))
                  .update({
                    isPaid: true,
                  });

                db.collection("transaction").add({
                  name: JSON.parse(localStorage.getItem("user")).name,
                  createdAt: new Date(),
                  amount: 499,
                });
              } else {
              }
            } catch (err) {
              console.log(err);
            }
          },
          theme: {
            color: "#686CFD",
          },
        };
        const rzp1 = new window.Razorpay(options);
        rzp1.open();
      };

      const applyJob = () => {
        // onScriptLoad();
        //fetch paytm

        db.collection("candidates")
          .doc(JSON.parse(localStorage.getItem("userId")))
          .get()
          .then(async (element) => {
            if (!localStorage.getItem("user")) {
              window.location.href = "login.html";
            } else if (element.data().isPaid) {
              db.collection("appliedJob")
                .add({
                  id: params.id,
                  isSelected: false,
                  userid: JSON.parse(localStorage.getItem("userId")),
                  company: company,
                  createdAt: new Date(),
                })
                .then(() => {
                  window.alert("Applied successfully");
                });
            } else {
              paymentHandler();
            }
          });
      };

      if (!JSON.parse(localStorage.getItem("userId"))) {
        document.getElementById("reglog").style.display = "inline";
        document.getElementById("logout").style.display = "none";

        var wrapper2 = document.createElement("div");
        wrapper2.innerHTML = `
                      <div>
                                  <a style="width:100%;" href="login.html">
                                    <button type="button" class="btn">Login</button>
                                  </a>
                                  <a style="width:100%;" href="register.html">
                                    <button type="button" class="btn">
                                      Register
                                    </button>
                                  </a>
                                </div>

                      `;

        document.getElementsByClassName("reglog1")[0].append(wrapper2);
        console.log("t");
      } else {
        document.getElementById("reglog").style.display = "none";
        document.getElementById("logout").style.display = "inline";
        var wrapper2 = document.createElement("div");
        wrapper2.innerHTML = `
                      <div class="logout1">
                                  <a style="width:100%;" href="profile.html" class="btn head-btn1"
                                    ><button type="button" class="btn">
                                      <i class="fa fa-user"></i>
                                    </button>
                                  </a>
                                </div>

                      `;

        document.getElementsByClassName("reglog1")[0].append(wrapper2);
        console.log("t2");
      }
      document.getElementById("logoutbtn").onclick = () => {
        firebase
          .auth()
          .signOut()
          .then(() => {
            localStorage.clear();
            window.location.href = "login.html";
          })
          .catch((error) => {
            console.log(err);
          });
      };
    </script>
  </body>
</html>
